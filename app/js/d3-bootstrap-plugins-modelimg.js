-(function(){var annotate;annotate=function(options,create){var el,move_tip;el=d3.select(this);move_tip=function(selection){var center,offsets;center=[0,0];var body;body=d3.select('#modelimg');if(options.title ==""){var remover,tip;tip=d3.selectAll(".annotation").classed('in',false);remover=function(){return tip.remove();};return setTimeout(remover,150);};if(options.placement==="mouse"){center=d3.mouse(body.node());}else{offsets=this.ownerSVGElement.getBoundingClientRect();center[0]=offsets.left;center[1]=offsets.top;center[0]+=options.position[0];center[1]+=options.position[1];center[0]+=window.scrollX;center[1]+=window.scrollY;}center[0]+=options.displacement[0];center[1]+=options.displacement[1];return selection.style("left",""+center[0]+"px").style("top",""+center[1]+"px").style("display","block");};el.on("mouseover",function(){var inner,tip;tip=create();tip.classed("annotation",true).classed(options.gravity,true).classed('fade',true).style("display","none");inner=function(){return tip.classed('in',true);};setTimeout(inner,10);return tip.style("display","").call(move_tip.bind(this));});if(options.mousemove){el.on("mousemove",function(){return d3.select(".annotation").call(move_tip.bind(this));});}return el.on("mouseout",function(){var remover,tip;tip=d3.selectAll(".annotation").classed('in',false);remover=function(){return tip.remove();};return setTimeout(remover,150);});};d3.selection.prototype.popover=function(f){var body;body=d3.select('#modelimg');return this.each(function(d,i){var create_popover,options;options=f.apply(this,arguments);create_popover=function(){var tip;tip=body.append("div").classed("popover fade top in popover-city",true).attr("role","tooltip");if(options.content["img"]){tip.append("div").attr("class","popover-content").html('<div class="media-left media-middle">'+'<img src="/bitrix/templates/main_template/img/city-img/'+options.content["img"]+'.jpg" class="popover-city__img">'+'</div>'+'<div class="media-body media-middle">'+'<h4 class="media-heading popover-city__title">'+options.title+'</h4>'+'<h5 class="popover-city__phone">'+options.content["phone"]+'</h5>'+'</div>');}else{tip.append("div").attr("class","popover-content").html(''+'<h4 class="media-heading popover-city__title">'+options.title+'</h4>'+'<h5 class="popover-city__phone">'+options.content["phone"]+'</h5>');}return tip;};return annotate.call(this,options,create_popover);});};d3.selection.prototype.tooltip=function(f){var body;body=d3.select('#modelimg');return this.each(function(d,i){var create_tooltip,options;options=f.apply(this,arguments);create_tooltip=function(){var tip;tip=body.append("div").classed("tooltip",true);tip.append("div").html(options.text).attr("class","tooltip-inner");return tip;};return annotate.call(this,options,create_tooltip);});};;})();